---
output:
  html_document:
    css: custom_styles.css
    fig_caption: yes
    includes:
      before_body: header_manual.html
      after_body: footer.html
params:
  park_code: FRSP
---
```{r site_info, echo=F, include=F, cache=F}
library(tidyverse)

siteinfo<-read.csv('site_info_NETN-MIDN-ERMN-NCRN.csv')
site<-siteinfo %>% filter(park_code==params$park_code) %>% droplevels()
network<-as.character(site$network_code)
contactinfo<-read.csv('contact_info.csv')
contact<-contactinfo %>% filter(network_code==network) %>% droplevels()

parkstatus<-read.csv('./results/Table_1_park-level_summaries.csv')
parks<-as.character(parkstatus[c(1:5,35:39),4])
parks<-c(parks,paste(as.character(site$park_code)))
parks<-unique(parks)
parkstatus_final<-parkstatus %>% filter(park_code %in% parks) %>% droplevels() 

sppstatus<-read.csv('./results/Table_2_species-level_summaries.csv')[1:10,c(1,2,4,5)]

# Park-level status
totinv<-read.csv('./results/park-level_summaries.csv')
parkinv<-totinv %>% filter(park==params$park_code) %>% droplevels()

guildinv<-read.csv('./results/park-level_summaries_guild.csv')
parkguild<-guildinv %>% filter(park==params$park_code) %>% droplevels() %>% 
  arrange(-avg.cover,-quad.pfreq,-plot.pfreq) %>% slice(1) 

allparkspp<-read.csv('./results/park-level_species_summaries.csv')
parkspp<-allparkspp %>% filter(park==params$park_code) %>% 
  arrange(-avg.cover, -qpct.freq, -plot.pfreq) %>% 
  select(sppgroup, Common, plot.pfreq, qpct.freq, avg.cover) %>% slice(1:5)

```
<div style="padding-left:10px;padding-right:5px;padding-top:5px;padding-bottom:5px;">
<h1><b>`r site$park`</b></h1>
<div class="column-left-fig1">
<h2><b>Background</b></h2>
</div>
<div class="column-right-fig1">
<div style="float:right;position:relative;top:5px; padding:5px 0 10px 15px;">
<div class='figcap'>
```{r, echo=F, out.width='400px', fig.cap='<p> Figure 1. Map of Eastern Forest Working Group parks', fig.pos='h'}
knitr::include_graphics('map_of_parks.jpg')
```
</div></div></div>

<div class="column-left-fig1">
The Eastern Forest Working Group of the National Park Service Inventory and Monitoring Program (I&M) has been monitoring forest health in permanent plots across 39 eastern national parks for 12+ years (Figure 1). Plots are sampled on a 4-year rotation. Currently nearly all 1,400+ plots have been sampled three times, allowing us to examine regional trends in park forests. We focused on invasive plants for our first regional trend analysis because they are a widespread concern across eastern parks. This brief summarizes results for `r site$park` (`r site$park_code`) in the `r site$network`.

In each park, we analyzed trends of invasive plant abundance across three cycles, with cycle 1= 2007-2010, cycle 2= 2011-2014, and cycle 3= 2015-2018. We assessed trends in plot-level frequency and quadrat-level frequency and average cover, and examined trends overall, by guild, and by species. The guild analyses grouped species into the following life forms: tree, shrub/vine, herbaceous, and graminoid. Graminoids are grasses, sedges or rushes. Herbaceous species are all non-woody vascular species that are not graminoids. We modeled each park individually and tested for significance using empirical 95% confidence intervals. For more details on the study and statistical methods, a draft manuscript is available upon request.

<h2><b>Results: Region</b></h2>
<h3>Status</h3>
</div>
<div class="column-right-fig1">
<div style="float:right;position:float;padding:10px 5px 5px 5px;">
<div class='figcap'>
```{r, echo=F}
figcap<-paste0('Table 1. Park-level summary of invasive abundance in ', site$park_code, ' (in blue) and the 5 most and 5 least invaded parks. Plot Freq. is the percent of plots in a park with at least one invasive species. Quad. % Freq. is the average percent of quadrats per plot with an invasive species. Avg. % Cover is the average cover of all invasive species monitored in a given park.')

row_num<-as.numeric(row.names(parkstatus_final[which(parkstatus_final$park_code== as.character(site$park_code)),]))
parkstatus_final<-parkstatus_final %>% select(-park)
knitr::kable(parkstatus_final, caption=figcap, format='html', align=c('c','c','c','c','c','c'),
             col.names=c('Rank','Network','Park','Plot % Freq.','Quad. % Freq.', 'Avg. % Cov')) %>% 
             kableExtra::kable_styling(full_width=F, position='float_right', bootstrap_options=c('striped','bordered','condensed')) %>% 
             kableExtra::row_spec(row_num, bold=TRUE, color='#336699') %>% 
             kableExtra::column_spec(1, width="0.2in") %>% 
             kableExtra::column_spec(2, width="0.4in") %>% 
             kableExtra::column_spec(4:6, width="0.65in") %>%
             kableExtra::column_spec(3, width="0.65in")
```
</div></div></div>
<div class="column-left-fig1">
Invasive species are widespread in eastern national parks. In 35 out of the 39 parks in this study, more than half of the plots in a given park had at least one invasive species, and in ten parks every plot had at least one invasive species present. In 21 out of 39 parks, at least one invasive species occurred in 50% or more of the quadrats in each plot. Average cover of invasives was over 20% in 10 out of 39 parks. The 5 parks with the highest invasive abundance were Monocacy National Battlefield (MONO), Antietam National Battlefield (ANTI), Friendship Hill National Historic Site (FRHI), Morristown National Historical Park (MORR), and Chesapeake and Ohio Canal National Historical Park (CHOC), with each park averaging more than 30% invasive cover (Table 1). The least invaded parks were Acadia National Park (ACAD), Marsh-Billings-Rockefeller National Historical Park (MABI), Fredericksburg \& Spotsylvania National Military Park (FRSP), Prince William Forest Park (PRWI), and Saint-Gaudens National Historical Park (SAGA), with all but SAGA averaging less than 1\% invasive cover.

Present in over 30% of the plots and 85% of the parks in this study, Japanese stiltgrass (<i>Microstegium vimineum</i>) was the most widespread invasive species in our study (Table 2). After Japanese stiltgrass, invasive shrubs/woody vines were the most abundant invasives, including Japanese barberry (<i>Berberis thunbergii</i>), Japanese honeysuckle (<i>Lonicera japonica</i>), multiflora rose (<i>Rosa multiflora</i>), and wineberry (<i>Rubus phoenicolasius</i>). 
<br>

<h3>Trends</h3>
Overall, increasing trends in invasive abundance were much more common than decreasing trends. In 30 out of the 37 parks analyzed for trends, we detected at least one significant increasing trend in invasive abundance, and 22 parks had five or more significant increases in invasive abundance. Japanese stiltgrass (<i>Microstegium vimineum</i>) had the most number of significant increases, with increases in plot frequency in five parks, quadrat frequency in twelve parks, and average cover in twelve parks. Invasive shrubs also increased in multiple parks, particularly in the northern parks in this study, where dense thickets can occur (Figure 2). The few signifcant declines that we detected were typically herbaceous species or Japanese stiltgrass (<i>Microstegium vimineum</i>), and they were often met with a roughly equivalent increase by another species and/or guild, especially invasive shrubs. 
</div>

<div class="column-left-fig1">
Only two parks in our study showed overall declines in invasive abundance: PRWI and MABI. In both parks, only significant negative trends in invasive abundance were detected, and both parks had relatively low invasive abundance at the start of monitoring. Three additional parks had low invasive abundance throughout the study period and did not have any significant increasing trends: ACAD, Colonial National Historical Park (COLO), SAGA. While invasive abundance is relatively low in these five parks, the species that are present, such as Japanese barberry (<i>Berberis thunbergii</i>) and Japanese stiltgrass (<i>Microstegium vimineum</i>), occupy very high abundance and have expanded rapidly in other parks in our study.
</div>
<div class="column-right-fig1">
<div style="float:right;position:relative; top:-5px;padding:5px 5px 10px 5px;">
<div class='figcap'>
```{r, echo=F}
knitr::kable(sppstatus, escape=F, caption='Table 2. Top ten most common species across parks.', format='html',
             col.names=c('Latin Name','Common','% of Plots','% of Parks'), align=c('l','l','c','c')) %>% 
             kableExtra::kable_styling(full_width=F, position='float_right', 
                                       bootstrap_options=c('striped', 'bordered', 'condensed')) %>% 
             kableExtra::column_spec(1, italic=T) %>% 
             kableExtra::column_spec(3:4, width="0.651in") 
```
</div></div></div>
<h2><b>Results: `r site$park_code`</b></h2>
<h3>Status</h3>
In the most recent cycle in `r site$park_code`, at least one invasive species was detected in `r format(round(parkinv$plot.pfreq,1),nsmall=1)`\% of plots, and on average, `r format(round(parkinv$quad.pfreq,1),nsmall=1)`\% of quadrats had at least one invasive species and average total invasive cover was `r ifelse(parkinv$avg.cover< 0.01, paste0("<0.01"), format(round(parkinv$avg.cover, 1),nsmall=1))`\% (Table 1). The `r str_to_lower(parkguild$guild)` guild was the most abundant guild in `r site$park_code`, found in `r format(round(parkguild$plot.pfreq,1),nsmall=1)`\% of plots, and averaging `r format(round(parkguild$quad.pfreq,1), nsmall = 1)`\% quadrat frequency, and `r ifelse(parkguild$avg.cover< 0.01, paste0("<0.01"),paste0(format(round(parkguild$avg.cover,1),nsmall=1)))`\% quadrat cover. The most abundant invasive species in `r site$park_code` was `r paste0(parkspp$Common[1])` (<i>`r paste0(parkspp$sppgroup[1])`</i>), occurring in `r format(round(parkspp$plot.pfreq[1],1),nsmall=1)`\% of plots, and averaging `r format(round(parkspp$avg.cover[1],1),nsmall=1)` \% cover. `r str_to_sentence(paste0(parkspp$Common[2]))` (<i>`r paste0(parkspp$sppgroup[2])`</i>) was the second most abundant invasive species, occurring in `r parkspp$plot.pfreq[2]`\% of plots, and averaging `r parkspp$avg.cover[2]` \% cover. The next three most abundant invasive species in `r site$park_code` were `r paste0(parkspp$Common[3])` (<i>`r paste0(parkspp$sppgroup[3])`</i>), `r paste0(parkspp$Common[4])` (<i>`r paste0(parkspp$sppgroup[4])`</i>), and `r paste0(parkspp$Common[5])` (<i>`r paste0(parkspp$sppgroup[5])`</i>).

```{r 'trend_summaries', echo=F, include=F}
# Compile trend data for param park
# Total invasives
plot_freq_tot<-read.csv('./results/results_PFreq-total-coefs.csv')
quad_freq_tot<-read.csv('./results/results_qfreq-total-coefs_NP.csv')
avg_cov_tot<-read.csv('./results/results_avecov-total-coefs_NP.csv')

filter_tot_trends<-function(df, metric){
  if(metric=='plot frequency'){
  df<-df %>% filter(park==params$park_code, coef=='Slope', sign==1) %>% droplevels() %>% 
  select(estimate) %>% mutate(metric=paste('plot frequency'), estimate=exp(estimate))
  } else {
  
  df<-df %>% filter(park==params$park_code, coef=='Slope', sign==1) %>% droplevels() %>% 
  select(estimate) %>%  mutate(metric=paste(metric))
  }
return(df)    
}

park_PF_tot <- filter_tot_trends(plot_freq_tot, 'plot frequency')
park_QF_tot <- filter_tot_trends(quad_freq_tot, 'quadrat frequency')
park_AC_tot <- filter_tot_trends(avg_cov_tot, 'average cover')

results_tot<-rbind(park_PF_tot,park_QF_tot,park_AC_tot)
results_tot<-results_tot %>% 
  mutate(prose=ifelse(metric!='plot frequency',
                      paste0(str_to_sentence(metric), ' of total invasives',
                              ifelse(estimate>0,' increased significantly by ',
                                                ' decreased significantly by '),                                                                round(estimate,1),'% per cycle.'),
                      paste0('An invasive species ','was ', round(estimate,1), ' times ',  
                              ifelse(estimate>1,'more ',
                                                'less '), 
                             'likely to occur in subsequent cycles.')))


results_tot_paste<-function(x){paste(" ", x[3], sep="")}
tot_results<-apply(results_tot,1,results_tot_paste)

# Guild level
plot_freq_guild<-read.csv('./results/results_PFreq-by_guild-coefs.csv')
quad_freq_guild<-read.csv('./results/results_qfreq-by_guild-coefs_NP.csv')
avg_cov_guild<-read.csv('./results/results_avecov-by_guild-coefs_NP.csv')

filter_guild_trends<-function(df, metric){
  if(metric=='plot frequency'){
  df<-df %>% filter(park==params$park_code, coef=='Slope', sign==1) %>% droplevels() %>% 
  select(guild, estimate) %>% mutate(metric=paste('plot frequency'),   
                                               estimate=exp(estimate))
  } else {
  
  df<-df %>% filter(park==params$park_code, coef=='Slope', sign==1) %>% droplevels() %>% 
  select(guild, estimate) %>% mutate(metric=paste(metric))
  }
return(df)    
}

park_PF_guild <- filter_guild_trends(plot_freq_guild, 'plot frequency')
park_QF_guild <- filter_guild_trends(quad_freq_guild, 'quadrat frequency')
park_AC_guild <- filter_guild_trends(avg_cov_guild, 'average cover')

results_guild<-rbind(park_PF_guild,park_QF_guild,park_AC_guild)
results_guild<-results_guild %>% 
  mutate(guild=ifelse(metric!='plot frequency', 
                      paste0(str_to_sentence(guild)),
                      paste0('The invasive ', tolower(guild), ' guild')),
         prose=ifelse(metric!='plot frequency',
                      paste0(metric,
                              ifelse(estimate>0,' increased significantly by ',
                                                ' decreased significantly by '),                                                                round(estimate,1),'% per cycle.'),
                      paste0('was ', round(estimate,1), ' times ',  
                              ifelse(estimate>1,'more ',
                                                'less '), 
                             'likely to occur in subsequent cycles.')))
results_guild_paste<-function(x){paste(" ", x[1], " ", x[4], sep="")}
guild_results<-apply(results_guild,1,results_guild_paste)

# Species level
invlist<-read.csv('./results/Invasive_List.csv')[,c('Latin_Name','Common')]
plot_freq_spp<-read.csv('./results/results_PFreq-by_species-coefs.csv')
quad_freq_spp<-read.csv('./results/results_qfreq-by_species-coefs_NP.csv')
avg_cov_spp<-read.csv('./results/results_avecov-by_species-coefs_NP.csv')

filter_spp_trends<-function(df, metric){
  if(metric=='plot frequency'){
  df<-df %>% filter(park==params$park_code, coef=='Slope', sign==1) %>% droplevels() %>% 
  select(species, estimate) %>% left_join(., invlist, by=c('species'='Latin_Name')) %>% 
  select(Common, species, estimate) %>% mutate(metric=paste('plot frequency'),   
                                               estimate=exp(estimate))
  } else {
  
  df<-df %>% filter(park==params$park_code, coef=='Slope', sign==1) %>% droplevels() %>% 
  select(species, estimate) %>% left_join(., invlist, by=c('species'='Latin_Name')) %>% 
  select(Common, species, estimate) %>% mutate(metric=paste(metric))
  }
return(df)    
}

park_PF_spp <- filter_spp_trends(plot_freq_spp, 'plot frequency')
park_QF_spp <- filter_spp_trends(quad_freq_spp, 'quadrat frequency')
park_AC_spp <- filter_spp_trends(avg_cov_spp, 'average cover')

results_spp<-rbind(park_PF_spp,park_QF_spp,park_AC_spp)
results_spp<-results_spp %>% 
  mutate(Common=str_to_sentence(Common),
         prose=ifelse(metric!='plot frequency',
                      paste0(metric,
                              ifelse(estimate>0,' increased significantly by ',
                                                ' decreased significantly by '),                                                                round(estimate,1),'% per cycle.'),
                      paste0('was ', round(estimate,1), ' times ',  
                              ifelse(estimate>1,'more ',
                                                'less '), 
                             'likely to occur in subsequent cycles.')))

results_spp_paste<-function(x){paste(" ", x[1], " (", "<i>", x[2], "</i>", ") ", x[5], sep="")}
spp_results<-apply(results_spp,1,results_spp_paste)

no_trends <- unique(c(rbind(tot_results, guild_results, spp_results)))

```
<div class="column-left-fig1">
<h3>Trends</h3>
`r if(length(no_trends)==0){paste0('There were no significant trends in total invasive abundance, guild-level abundance, or species level abundance in ', site$park, '. ')}``r if(length(no_trends)>2){paste0('There were a total of ', length(no_trends), ' significant trends in invasive abundance in ', site$park,'. ')}`
`r if(length(no_trends!=0) & length(tot_results)==0){paste0(' There were no significant trends in total invasive abundance.')}``r if(length(no_trends!=0) & length(tot_results)!=0){paste0(tot_results, collapse=' ')}``r if(length(no_trends!=0) & length(guild_results)==0){paste0('There were no significant guild-level trends.')}``r if(length(no_trends!=0) & length(guild_results)!=0){paste0(guild_results, collapse=' ')}` `r if(length(no_trends!=0) & length(spp_results)==0){paste0(' There were no significant species-level trends.')}``r if(length(no_trends!=0) & length(spp_results)!=0){paste0(spp_results, collapse=' ')}`
</div>

<div class="column-left-fig1">
<h2><b>Conclusions</b></h2>
Japanese stiltgrass was the most aggressive invasive species in our study, particularly in the mid-Atlantic region, and should be a top priority for invasive management. Invasive shrubs were also common in eastern parks, were the most often increasing invasive species in the northern region of our study, and also appeared to outcompete Japanese stiltgrass in some cases. Given the added risks to human health from tick-borne diseases in invasive shrub thickets, invasive shrubs as a guild should be a high management priority.

The high and often increasing abundance of invasives that we documented in the majority of the parks in our study poses significant threats to the long-term condition of eastern park forests. While many of the parks in our study have active invasive management, few have the base-funded and dedicated permanent staff needed for effective invasive management. Reversing these trends will be challenging, costly, and require a longer term commitment to manage invasives and reduce the underlying drivers contributing to the invasive problem. Without such efforts, invasive problems in parks will only get worse. Just as parks are working to overcome deferred maintenance of infrastructure, deferred management of natural resources requires equal attention to ensure the long-term health of park forests.
</div>
<div class="column-right-fig1">
<div style="float:right;position:relative;top:-5px;right:1px; padding:5px 5px 5px 10px;">
<div class='figcap'>
```{r, echo=F, out.width='450px', fig.cap='<p> Figure 2. Invasive shrub thicket in Morristown National Historical Park.', fig.pos='h'}
knitr::include_graphics('MORR_019_20170529_barberry.jpg')
```
</div></div></div>

<h2><b>More Information</b></h2>
More information about the Eastern Forest Working Group can be found on the <a href="https://www.researchgate.net/project/Forest-Monitoring-in-National-Park-Units-of-the-Eastern-USA">EFWG Research Gate Project</a>. More information on network-specific monitoring can be found on the <a href="`r contact$website`">`r site$network_code` website</a>, or by contacting: `r contact$name1`, `r contact$email1`, or  `r contact$name2`, `r contact$email2`.
</div>